<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Handling Expression Matrices with ImmuneSpaceR • ImmuneSpaceR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Handling Expression Matrices with ImmuneSpaceR">
<meta property="og:description" content="ImmuneSpaceR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118281859-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118281859-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ImmuneSpaceR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.19.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro_to_ImmuneSpaceR.html">An Introduction to the ImmuneSpaceR Package</a>
    </li>
    <li>
      <a href="../articles/getDataset.html">Downloading Datasets with getDataset</a>
    </li>
    <li>
      <a href="../articles/getGEMatrix.html">Handling Expression Matrices with ImmuneSpaceR</a>
    </li>
    <li>
      <a href="../articles/interactiveNetrc.html">interactive_netrc() Function Walkthrough</a>
    </li>
    <li>
      <a href="../articles/report_SDY144.html">SDY144: Correlation of HAI/Virus Neutralizition Titer and Cell Counts</a>
    </li>
    <li>
      <a href="../articles/report_SDY180.html">SDY180: Abundance of Plasmablasts Measured by Multiparameter Flow Cytometry</a>
    </li>
    <li>
      <a href="../articles/report_SDY269.html">SDY269: Correlating HAI with Flow Cytometry and ELISPOT Results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.immunespace.org/">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ImmuneSpace">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/RGLab/ImmuneSpaceR">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getGEMatrix_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Handling Expression Matrices with ImmuneSpaceR</h1>
                        <h4 class="author">Renan Sauteraud</h4>
            
            <h4 class="date">2021-07-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/RGLab/ImmuneSpaceR/blob/master/vignettes/getGEMatrix.Rmd"><code>vignettes/getGEMatrix.Rmd</code></a></small>
      <div class="hidden name"><code>getGEMatrix.Rmd</code></div>

    </div>

    
    
<p>This vignette shows detailed examples for the <code><a href="../reference/ImmuneSpaceConnection.html">getGEMatrix()</a></code> method</p>
<div id="create-connections" class="section level1">
<h1 class="hasAnchor">
<a href="#create-connections" class="anchor"></a>Create connections</h1>
<p>As explained into the introductory vignette, datasets must be downloaded from <code>ImmuneSpaceConnection</code> objects. We must first instantiate a connection to the study or studies of interest. Throughout this vignette, we will use two connections, one to a single study, and one to to all available data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/ImmuneSpaceR">ImmuneSpaceR</a></span><span class="op">)</span>
<span class="va">sdy269</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CreateConnection.html">CreateConnection</a></span><span class="op">(</span><span class="st">"SDY269"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in matrix(data = unlist(curfld[resultCols]), nrow = 1, ncol =
## length(resultCols), : data length [4] is not a sub-multiple or multiple of the
## number of columns [7]</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CreateConnection.html">CreateConnection</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in matrix(data = unlist(curfld[resultCols]), nrow = 1, ncol =
## length(resultCols), : data length [4] is not a sub-multiple or multiple of the
## number of columns [7]</code></pre>
</div>
<div id="list-the-expression-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#list-the-expression-matrices" class="anchor"></a>List the expression matrices</h1>
<p>Now that the connections have been instantiated, we can start downloading from them. But we need to figure out which processed matrices are available within our chosen studies.</p>
<p>On the ImmuneSpace portal, in the study of interest or at the project level, the <strong>Gene expression matrices</strong> table will show the available runs.</p>
<p>Printing the connections will, among other information, list the datasets availables. The <code>listDatasets</code> method will only display the downloadable data. looking for. With <code>output = "expression"</code>, the datasets wont be printed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sdy269</span><span class="op">$</span><span class="fu">listDatasets</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## datasets
##  cohort_membership
##  demographics
##  elisa
##  elispot
##  fcs_analyzed_result
##  fcs_sample_files
##  gene_expression_files
##  hai
##  pcr
## Expression Matrices
##  SDY269_PBMC_TIV_Geo
##  SDY269_PBMC_LAIV_Geo</code></pre>
<p>Using <code>output = "expression"</code>, we can remove the datasets from the output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all</span><span class="op">$</span><span class="fu">listDatasets</span><span class="op">(</span>output <span class="op">=</span> <span class="st">"expression"</span><span class="op">)</span></code></pre></div>
<pre><code>## Expression Matrices
##  SDY1630_Spleen_AllSubjects
##  SDY1630_PBMC_AllSubjects
##  SDY1630_LungLymphNode_AllSubjects
##  SDY1630_Lung_AllSubjects
##  SDY1630_BoneMarrow_AllSubjects
##  SDY1529_WholeBlood_HealthyAdults_PreVax_Geo
##  SDY1529_WholeBlood_HealthyAdults_PostVax_Geo
##  SDY787_Tcell_wPaPboost_Geo
##  SDY787_Tcell_aP_Geo
##  SDY787_Tcell_aPaPboost_Geo
##  SDY1328_WholeBlood_HealthyAldults_Geo
##  SDY520_WholeBlood_Young_geo
##  SDY520_WholeBlood_Older_Geo
##  SDY640_WholeBlood_Young_Geo
##  SDY640_WholeBlood_Older_Geo
##  SDY1086_PBMC_GroupB_Geo
##  SDY1086_PBMC_GroupA_Geo
##  SDY1267_PBMC_RRR_Geo
##  SDY1267_PBMC_ARR_Geo
##  SDY1412_WholeBlood_EPC002_geo
##  SDY1256_WholeBlood_EPIC001_geo
##  SDY80_PBMC_Cohort2_geo
##  SDY299_WholeBlood_HEPISLAV
##  SDY180_WholeBlood_Grp2Saline_Geo
##  SDY180_WholeBlood_Grp2Pneunomax23_Geo
##  SDY180_WholeBlood_Grp2Fluzone_Geo
##  SDY180_WholeBlood_Grp1Saline_Geo
##  SDY180_WholeBlood_Grp1Pneunomax23_Geo
##  SDY180_WholeBlood_Grp1Fluzone_Geo
##  SDY1325_WholeBlood_LowIntraMuscularPS_geo
##  SDY1294_PBMC_ChineseCohort_Geo
##  SDY1119_PBMC_oldHealthy_Geo
##  SDY1119_PBMC_oldT2D_Geo
##  SDY1119_PBMC_youngT2D_Geo
##  SDY1119_PBMC_youngHealthy_Geo
##  SDY1289_WholeBlood_MontrealCohort_Geo
##  SDY1289_WholeBlood_LausanneCohort_Geo
##  SDY1324_PBMC_nonBCGvacc
##  SDY1324_PBMC_LatentTB
##  SDY1324_PBMC_BCGvacc
##  SDY89_WholeBlood_EnergixB
##  SDY1370_Bcell_lc16m8_geo
##  SDY1370_Bcell_dryvax_geo
##  SDY1370_Tcell_lc16m8_geo
##  SDY1370_Tcell_dryvax_geo
##  SDY1370_PBMC_lc16m8_geo
##  SDY1370_PBMC_dryvax_geo
##  SDY1368_WholeBlood_Twin_Geo
##  SDY1368_WholeBlood_NonTwin_Geo
##  SDY67_PBMC_HealthyAdults
##  SDY224_PBMC_TIV2010_ImmPort
##  SDY888_PBMC_UninfectedEndemicArea_Geo
##  SDY888_PBMC_UninfectedNonEndemicArea_Geo
##  SDY888_PBMC_InfectedEndemicArea_Geo
##  SDY28_PBMC_Dryvax
##  SDY34_PBMC_TIV
##  SDY34_PBMC_Controls
##  SDY305_Other_IDTIV_Geo
##  SDY305_Other_TIV_Geo
##  SDY112_Other_GroupC
##  SDY112_Other_GroupB
##  SDY112_Other_GroupA
##  SDY315_Other_GroupC_Geo
##  SDY315_Other_GroupB_Geo
##  SDY315_Other_GroupA_Geo
##  SDY406_Other_ILI_Geo
##  SDY113_Other_IDTIV_Geo
##  SDY113_Other_LAIV_Geo
##  SDY113_Other_TIV_Geo
##  SDY144_Other_TIV_Geo
##  SDY690_PBMC_Energixb
##  SDY690_WholeBlood_Energixb
##  SDY597_Other_InVitro
##  SDY522_Other_LAIV
##  SDY387_WholeBlood_NCH2010
##  SDY372_WholeBlood_JDM2012
##  SDY368_WholeBlood_NCH2013
##  SDY364_WholeBlood_NCH2012
##  SDY312_Other_GroupC
##  SDY312_Other_GroupB
##  SDY312_Other_GroupA
##  SDY301_Other_AIRFV
##  SDY296_WholeBlood_AIRFV
##  SDY667_WholeBlood_PSORPPP
##  SDY212_WholeBlood_Older_Geo
##  SDY212_WholeBlood_Young_Geo
##  SDY212_PBMC_Older_Geo
##  SDY212_PBMC_Young_geo
##  SDY270_PBMC_TIVGroup_Geo
##  SDY1373_WholeBlood_highDose_Geo
##  SDY1373_WholeBlood_lowDose_Geo
##  SDY1364_PBMC_IntraDermal_Geo
##  SDY1364_PBMC_IntraMuscular_Geo
##  SDY1325_WholeBlood_IntramuscularCRM_Geo
##  SDY1325_WholeBlood_IntramuscularPS_Geo
##  SDY1325_WholeBlood_SubcutaneousPS_Geo
##  SDY1291_PBMC_HealthyHIVUninfected_Geo
##  SDY1293_PBMC_Vaccinated_geo
##  SDY1293_PBMC_Control_Geo
##  SDY1276_WholeBlood_Validation_Geo
##  SDY1276_WholeBlood_Discovery_Geo
##  SDY1264_PBMC_Trial2_Geo
##  SDY1264_PBMC_Trial1_Geo
##  SDY1260_PBMC_MCV4_Geo
##  SDY1260_PBMC_MPSV4_Geo
##  SDY984_PBMC_Elderly_Geo
##  SDY984_PBMC_Young_Geo
##  SDY61_PBMC_TIVGrp
##  SDY56_PBMC_Older
##  SDY56_PBMC_Young
##  SDY63_PBMC_Young_Geo
##  SDY63_PBMC_Older_Geo
##  SDY404_PBMC_Young_Geo
##  SDY404_PBMC_Older_Geo
##  SDY400_PBMC_Older_Geo
##  SDY400_PBMC_Young_Geo
##  SDY269_PBMC_TIV_Geo
##  SDY269_PBMC_LAIV_Geo
##  SDY300_dendriticCell_dcMonoFlu2011
##  SDY300_otherCell_dcMonoFlu2011
##  SDY162_Macrophage_VLplus
##  SDY162_PBMC_VLplus
##  SDY162_Macrophage_VLminus
##  SDY162_PBMC_VLminus</code></pre>
<p>Naturally, <code>all</code> contains every processed matrices available on ImmuneSpace as it combines all available studies.</p>
</div>
<div id="download" class="section level1">
<h1 class="hasAnchor">
<a href="#download" class="anchor"></a>Download</h1>
<div id="by-run-name" class="section level2">
<h2 class="hasAnchor">
<a href="#by-run-name" class="anchor"></a>By run name</h2>
<p>The <code>getGEMatrix</code> method will accept any of the run names listed in the connection.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TIV_2008</span> <span class="op">&lt;-</span> <span class="va">sdy269</span><span class="op">$</span><span class="fu">getGEMatrix</span><span class="op">(</span><span class="st">"SDY269_PBMC_TIV_Geo"</span><span class="op">)</span></code></pre></div>
<pre><code>## Downloading matrix..</code></pre>
<pre><code>## Constructing ExpressionSet</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TIV_2011</span> <span class="op">&lt;-</span> <span class="va">all</span><span class="op">$</span><span class="fu">getGEMatrix</span><span class="op">(</span>matrixName <span class="op">=</span> <span class="st">"SDY144_Other_TIV_Geo"</span><span class="op">)</span></code></pre></div>
<pre><code>## Downloading matrix..
## Constructing ExpressionSet</code></pre>
<p>The matrices are returned as <code>ExpressionSet</code> where the phenoData slot contains basic demographic information and the featureData slot shows a mapping of probe to official gene symbols.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TIV_2008</span></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 16146 features, 80 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: BS586128 BS586240 ... BS586267 (80 total)
##   varLabels: participant_id study_time_collected ...
##     exposure_process_preferred (8 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: DDR1 RFC2 ... NUS1P3 (16146 total)
##   fvarLabels: FeatureId gene_symbol
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation:</code></pre>
</div>
<div id="by-cohorttype" class="section level2">
<h2 class="hasAnchor">
<a href="#by-cohorttype" class="anchor"></a>By cohortType</h2>
<p>The <code>cohortType</code> argument can be used in place of the run name (<code>x</code>). It is a concatenation of “cohort” and “cell type” so that you may use matrices for analysis that have been normalized within cell-type. Likewise, the list of valid cohortTypes can be found in the Gene expression matrices table.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LAIV_2008</span> <span class="op">&lt;-</span> <span class="va">sdy269</span><span class="op">$</span><span class="fu">getGEMatrix</span><span class="op">(</span>cohortType <span class="op">=</span> <span class="st">"LAIV group 2008_PBMC"</span><span class="op">)</span></code></pre></div>
<pre><code>## Downloading matrix..</code></pre>
<pre><code>## Constructing ExpressionSet</code></pre>
<p>Note that when cohort is used, <code>x</code> is ignored.</p>
</div>
</div>
<div id="summarized-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#summarized-matrices" class="anchor"></a>Summarized matrices</h1>
<p>By default, the returned <code>ExpressionSet</code>s have probe names as features (or rows). However, multiple probes often match the same gene and merging experiments from different arrays is impossible at feature level. When they are available, the <code>summary</code> argument allows to return the matrices with gene symbols instead of probes. You should use <code>currAnno</code> set to <code>TRUE</code> to use the latest official gene symbols mapped for each probe, but you can also set this to <code>FALSE</code> to retrieve the original mappings from when the matrix was created.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TIV_2008_sum</span> <span class="op">&lt;-</span> <span class="va">sdy269</span><span class="op">$</span><span class="fu">getGEMatrix</span><span class="op">(</span><span class="st">"SDY269_PBMC_TIV_Geo"</span>, outputType <span class="op">=</span> <span class="st">"summary"</span>, annotation <span class="op">=</span> <span class="st">"latest"</span><span class="op">)</span></code></pre></div>
<pre><code>## Returning SDY269_PBMC_TIV_Geo_summary_latest_eset from cache</code></pre>
<p>Probes that do not map to a unique gene are removed and expression is averaged by gene.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TIV_2008_sum</span></code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 16146 features, 80 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: BS586128 BS586240 ... BS586267 (80 total)
##   varLabels: participant_id study_time_collected ...
##     exposure_process_preferred (8 total)
##   varMetadata: labelDescription
## featureData
##   featureNames: DDR1 RFC2 ... NUS1P3 (16146 total)
##   fvarLabels: FeatureId gene_symbol
##   fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation:</code></pre>
</div>
<div id="combining-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#combining-matrices" class="anchor"></a>Combining matrices</h1>
<p>In order to faciliate analysis across experiments and studies, when multiple runs or cohorts are specified, <code>getGEMatrix</code> will attempt to combine the selected expression matrices into a single <code>ExpressionSet</code>.</p>
<p>To avoid returning an empty object, it is usually recommended to use the summarized version of the matrices, thus combining by genes. This is almost always necessary when combining data from multiple studies.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Within a study</span>
<span class="va">em269</span> <span class="op">&lt;-</span> <span class="va">sdy269</span><span class="op">$</span><span class="fu">getGEMatrix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SDY269_PBMC_TIV_Geo"</span>, <span class="st">"SDY269_PBMC_LAIV_Geo"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Returning SDY269_PBMC_TIV_Geo_summary_latest_eset from cache</code></pre>
<pre><code>## Returning SDY269_PBMC_LAIV_Geo_summary_latest_eset from cache</code></pre>
<pre><code>## Combining ExpressionSets</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Combining across studies</span>
<span class="va">TIV_seasons</span> <span class="op">&lt;-</span> <span class="va">all</span><span class="op">$</span><span class="fu">getGEMatrix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SDY269_PBMC_TIV_Geo"</span>, <span class="st">"SDY144_Other_TIV_Geo"</span><span class="op">)</span>,
                               outputType <span class="op">=</span> <span class="st">"summary"</span>,
                               annotation <span class="op">=</span> <span class="st">"latest"</span><span class="op">)</span></code></pre></div>
<pre><code>## Downloading matrix..</code></pre>
<pre><code>## Constructing ExpressionSet</code></pre>
<pre><code>## Returning SDY144_Other_TIV_Geo_summary_latest_eset from cache</code></pre>
<pre><code>## Combining ExpressionSets</code></pre>
</div>
<div id="caching" class="section level1">
<h1 class="hasAnchor">
<a href="#caching" class="anchor"></a>Caching</h1>
<p>As explained in the introductory, the <code>ImmuneSpaceConnection</code> class is a <a href="https://cran.r-project.org/web/packages/R6/index.html"><code>R6</code></a> class. It means its objects have fields accessed by reference. As a consequence, they can be modified without making a copy of the entire object. ImmuneSpaceR uses this feature to store downloaded datasets and expression matrices. Subsequent calls to <code>getGEMatrix</code> with the same input will be faster.</p>
<p>See <code><a href="https://r6.r-lib.org/reference/R6Class.html">?R6::R6Class</a></code> for more information about R6 class system.</p>
<p>We can see a list of already downloaded runs and feature sets the <code>cache</code> field. This is not intended to be used for data manipulation and only displayed here to explain what gets cached.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sdy269</span><span class="op">$</span><span class="va">cache</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "GE_matrices"                             
## [2] "SDY269_PBMC_TIV_Geo_sum_latest"          
## [3] "featureset_18"                           
## [4] "SDY269_PBMC_TIV_Geo_summary_latest_eset" 
## [5] "SDY269_PBMC_LAIV_Geo_sum_latest"         
## [6] "SDY269_PBMC_LAIV_Geo_summary_latest_eset"</code></pre>
<p>If, for any reason, a specific marix needs to be redownloaded, the <code>reload</code> argument will clear the cache for that specific <code>getGEMatrix</code> call and download the file and metadata again.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TIV_2008</span> <span class="op">&lt;-</span> <span class="va">sdy269</span><span class="op">$</span><span class="fu">getGEMatrix</span><span class="op">(</span><span class="st">"SDY269_PBMC_TIV_Geo"</span>, reload <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Downloading matrix..</code></pre>
<pre><code>## Constructing ExpressionSet</code></pre>
<p>Finally, it is possible to clear every cached expression matrix (and dataset).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sdy269</span><span class="op">$</span><span class="fu">clearCache</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Again, the <code>cache</code> field should never be modified manually. When in doubt, simply reload the expression matrix.</p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ImmuneSpaceR_1.19.2 knitr_1.33         
## 
## loaded via a namespace (and not attached):
##  [1] ncdfFlow_2.38.0       bitops_1.0-7          matrixStats_0.59.0   
##  [4] fs_1.5.0              webshot_0.5.2         RColorBrewer_1.1-2   
##  [7] httr_1.4.2            rprojroot_2.0.2       Rgraphviz_2.36.0     
## [10] tools_4.1.0           utf8_1.2.1            R6_2.5.0             
## [13] KernSmooth_2.23-20    BiocGenerics_0.38.0   lazyeval_0.2.2       
## [16] colorspace_2.0-2      flowWorkspace_4.4.0   tidyselect_1.1.1     
## [19] gridExtra_2.3         preprocessCore_1.54.0 curl_4.3.2           
## [22] compiler_4.1.0        textshaping_0.3.5     graph_1.70.0         
## [25] Biobase_2.52.0        TSP_1.1-10            xml2_1.3.2           
## [28] desc_1.3.0            plotly_4.9.4.1        caTools_1.18.2       
## [31] scales_1.1.1          pkgdown_1.6.1         systemfonts_1.0.2    
## [34] stringr_1.4.0         digest_0.6.27         rmarkdown_2.9        
## [37] base64enc_0.1-3       jpeg_0.1-8.1          pkgconfig_2.0.3      
## [40] htmltools_0.5.1.1     fastmap_1.1.0         htmlwidgets_1.5.3    
## [43] rlang_0.4.11          flowCore_2.4.0        generics_0.1.0       
## [46] jsonlite_1.7.2        gtools_3.9.2          dendextend_1.15.1    
## [49] dplyr_1.0.7           magrittr_2.0.1        RProtoBufLib_2.4.0   
## [52] Rcpp_1.0.7            munsell_0.5.0         S4Vectors_0.30.0     
## [55] fansi_0.5.0           viridis_0.6.1         lifecycle_1.0.0      
## [58] stringi_1.7.3         yaml_2.2.1            zlibbioc_1.38.0      
## [61] gplots_3.1.1          grid_4.1.0            parallel_4.1.0       
## [64] crayon_1.4.1          lattice_0.20-44       pillar_1.6.1         
## [67] Rlabkey_2.8.0         codetools_0.2-18      stats4_4.1.0         
## [70] XML_3.99-0.6          glue_1.4.2            evaluate_0.14        
## [73] latticeExtra_0.6-29   data.table_1.14.0     RcppParallel_5.1.4   
## [76] foreach_1.5.1         png_0.1-7             vctrs_0.3.8          
## [79] gtable_0.3.0          aws.s3_0.3.21         purrr_0.3.4          
## [82] tidyr_1.1.3           heatmaply_1.2.1       assertthat_0.2.1     
## [85] cachem_1.0.5          ggplot2_3.3.5         xfun_0.24            
## [88] ragg_1.1.3            viridisLite_0.4.0     pheatmap_1.0.12      
## [91] seriation_1.3.0       tibble_3.1.2          iterators_1.0.13     
## [94] registry_0.5-1        cytolib_2.4.0         aws.signature_0.6.0  
## [97] memoise_2.0.0         ellipsis_0.3.2</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Greg Finak, Renan Sauteraud, Mike Jiang, Gil Guday, Leo Dashevskiy, Evan Henrich, Ju Yeong Kim, Lauren Wolfe, Helen Miller, Raphael Gottardo, ImmuneSpace Package Maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
